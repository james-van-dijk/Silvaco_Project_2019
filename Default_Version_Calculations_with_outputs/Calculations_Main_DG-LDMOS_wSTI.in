# This file was produced for a final project of McMaster's Engineering Physics 4Z03 Course. It was produced by James Van Dijk during the 2019 Fall semester. The contents incorporated techniques demonstrated in our tutorials (by Dave McShannon).

# !!!! Please note, this is an extremely verbose way of simulating this system (If I had more time to work on it, I would get the system to automatically generate the individual files according to the naming scheme detailed further below. Large chunks of this file should/could be done via simple FOR loops.

# However, doing calculations for each gate relative to the other is necessary because the system is asymmetrical (the plots will demonstrate this effect)

## Additionally, if you already have the generated files (for example obtaining them from the online repository " https://github.com/james-van-dijk/Silvaco_Project_2019 " in the "Default_Version_Calculations_with_outputs" subfolder), you can simply run the tonyplots or extract statements if you put a stop after them. Otherwise regenerating all of the files created by this script could take literal hours depending on your computer.

go ATLAS
# Remember to check the exact name of the infile generated by Athena AND PLACE A COPY IN THE SAME FOLDER AS THIS CALCULATION FILE
mesh infile=LDMOS_STI04_p2e18e45_n2e16e100_nti10te1000_ver1.str


#set the type of models
models mos print

#set the numerical method
method newton

# may have to specify as method newton carriers=2
# another option is METHOD 2ND TAUTO AUTONR (specified in manual in transient case)


#solve an IV curve
solve init

# Generating profiles for the various supplied voltages to the drain
solve vdrain=0.1
solve vdrain=1 outfile=drain1
solve vdrain=5 outfile=drain5
solve vdrain=10 outfile=drain10
solve vdrain=15 outfile=drain15

#NOTE: GateA is equivalent to gate1 (implemented because "one" looks like the letter "l"), Gateb is just the other gate

# these are a set of drain values holding gate 1 constant and sweeping through gate2
load infile=drain1
#naming convention Drain=1V, GateA=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D1Ga0G2sweep_n5top10
solve name=gate2 v2=0 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Ga1G2sweep_n5top10
solve name=gate2 v2=1 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Ga2G2sweep_n5top10
solve name=gate2 v2=2 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Ga3G2sweep_n5top10
solve name=gate2 v2=3 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Ga4G2sweep_n5top10
solve name=gate2 v2=4 v3=-5 vfinal=10 vstep=0.5
log off

load infile=drain1
log outfile=D1Ga5G2sweep_n5top10
solve name=gate2 v2=5 v3=-5 vfinal=10 vstep=0.5
log off


# Please note: I was unable to find a method of saving these individual extract statement results in a table, as a variable, as a string, list, datafile, outfile, history or logfile, so in order to create a table from the various extracted values that I am interested in (i.e. Threshold voltage, transconductance, Idsmax, and possibly Beta), I have to manually extract them from the "results.final" file. The results.final file lists multiple extracts in a single column as shown below:

#Vt=0.909983 V
#
#idsmax=1.14268e-006 A/um
#
#gm=3.90508e-007 

# And yes, the spaces, characters, and units are included in the results, this means automatically converting them to usable data, such as a .csv file for use in excel etc. requires additional work to separate, columnate, and graph. As such, I will manually input a few for the report and/or presentation, but it will not cover all of them (and it is not nearly as thorough as I want to be. Unfortunately, I dont have the time (at the time of writing this comment). These extract statements are included in each section for information purposes (i.e. "they are there if you want them".). I sincerely apologize, again, for how long this makes the file (and added difficulty in reading this code) 

extract init infile="D1Ga0G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D1Ga1G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D1Ga2G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D1Ga3G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D1Ga4G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D1Ga5G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))


tonyplot -overlay D1Ga0G2sweep_n5top10 D1Ga1G2sweep_n5top10 D1Ga2G2sweep_n5top10 D1Ga3G2sweep_n5top10 D1Ga4G2sweep_n5top10 D1Ga5G2sweep_n5top10


# these are a set of drain values holding gate 1 constant and sweeping through gate2
load infile=drain5
#naming convention Drain=5V, GateA=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D5Ga0G2sweep_n5top10
solve name=gate2 v2=0 v3=-5 vfinal=10 vstep=0.5
log off
log outfile=D5Ga1G2sweep_n5top10
solve name=gate2 v2=1 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Ga2G2sweep_n5top10
solve name=gate2 v2=2 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Ga3G2sweep_n5top10
solve name=gate2 v2=3 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Ga4G2sweep_n5top10
solve name=gate2 v2=4 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Ga5G2sweep_n5top10
solve name=gate2 v2=5 v3=-5 vfinal=10 vstep=0.5
log off


extract init infile="D5Ga0G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D5Ga1G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D5Ga2G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D5Ga3G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D5Ga4G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D5Ga5G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))

tonyplot -overlay D5Ga0G2sweep_n5top10 D5Ga1G2sweep_n5top10 D5Ga2G2sweep_n5top10 D5Ga3G2sweep_n5top10 D5Ga4G2sweep_n5top10 D5Ga5G2sweep_n5top10

# these are a set of drain values holding gate 1 constant and sweeping through gate2
load infile=drain10
#naming convention Drain=5V, GateA=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D10Ga0G2sweep_n5top10
solve name=gate2 v2=0 v3=-5 vfinal=10 vstep=0.5
log off
log outfile=D10Ga1G2sweep_n5top10
solve name=gate2 v2=1 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Ga2G2sweep_n5top10
solve name=gate2 v2=2 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Ga3G2sweep_n5top10
solve name=gate2 v2=3 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Ga4G2sweep_n5top10
solve name=gate2 v2=4 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Ga5G2sweep_n5top10
solve name=gate2 v2=5 v3=-5 vfinal=10 vstep=0.5
log off

extract init infile="D10Ga0G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D10Ga1G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D10Ga2G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D10Ga3G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D10Ga4G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D10Ga5G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))

tonyplot -overlay D10Ga0G2sweep_n5top10 D10Ga1G2sweep_n5top10 D10Ga2G2sweep_n5top10 D10Ga3G2sweep_n5top10 D10Ga4G2sweep_n5top10 D10Ga5G2sweep_n5top10

# these are a set of drain values holding gate 1 constant and sweeping through gate2
load infile=drain15
#naming convention Drain=5V, GateA=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D15Ga0G2sweep_n5top10
solve name=gate2 v2=0 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Ga1G2sweep_n5top10
solve name=gate2 v2=1 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Ga2G2sweep_n5top10
solve name=gate2 v2=2 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Ga3G2sweep_n5top10
solve name=gate2 v2=3 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Ga4G2sweep_n5top10
solve name=gate2 v2=4 v3=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Ga5G2sweep_n5top10
solve name=gate2 v2=5 v3=-5 vfinal=10 vstep=0.5
log off
# Finished sweep for drain = 1v

extract init infile="D15Ga0G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D15Ga1G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D15Ga2G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D15Ga3G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D15Ga4G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract init infile="D15Ga5G2sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate2"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate2"),abs(i."drain"))))

tonyplot -overlay D15Ga0G2sweep_n5top10 D15Ga1G2sweep_n5top10 D15Ga2G2sweep_n5top10 D15Ga3G2sweep_n5top10 D15Ga4G2sweep_n5top10 D15Ga5G2sweep_n5top10


save outfile=LDMOS_STI04_p2e18e45_n2e16e100_nti10te1000_ver1_gate2sweep.str
#save outfile=gate2sweepdrain.str
tonyplot LDMOS_STI04_p2e18e45_n2e16e100_nti10te1000_ver1_gate2sweep.str

###########################
# switch the sweeping gate
###########################


# these are a set of drain values holding gate 2 constant and sweeping through gate1
load infile=drain1
#naming convention Drain=1V, GateB=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D1Gb0G1sweep_n5top10
solve name=gate1 v3=0 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Gb1G1sweep_n5top10
solve name=gate1 v3=1 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Gb2G1sweep_n5top10
solve name=gate1 v3=2 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Gb3G1sweep_n5top10
solve name=gate1 v3=3 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Gb4G1sweep_n5top10
solve name=gate1 v3=4 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain1
log outfile=D1Gb5G1sweep_n5top10
solve name=gate1 v3=5 v2=-5 vfinal=10 vstep=0.5
log off



extract init infile="D1Gb0G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D1Gb1G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D1Gb2G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D1Gb3G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D1Gb4G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D1Gb5G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))



tonyplot -overlay D1Gb0G1sweep_n5top10 D1Gb1G1sweep_n5top10 D1Gb2G1sweep_n5top10 D1Gb3G1sweep_n5top10 D1Gb4G1sweep_n5top10 D1Gb5G1sweep_n5top10



# these are a set of drain values holding gate 2 constant and sweeping through gate1
load infile=drain5
#naming convention Drain=1V, GateB=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D5Gb0G1sweep_n5top10
solve name=gate1 v3=0 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Gb1G1sweep_n5top10
solve name=gate1 v3=1 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Gb2G1sweep_n5top10
solve name=gate1 v3=2 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Gb3G1sweep_n5top10
solve name=gate1 v3=3 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Gb4G1sweep_n5top10
solve name=gate1 v3=4 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain5
log outfile=D5Gb5G1sweep_n5top10
solve name=gate1 v3=5 v2=-5 vfinal=10 vstep=0.5
log off


extract init infile="D5Gb0G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D5Gb1G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D5Gb2G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D5Gb3G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D5Gb4G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D5Gb5G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))


tonyplot -overlay D5Gb0G1sweep_n5top10 D5Gb1G1sweep_n5top10 D5Gb2G1sweep_n5top10 D5Gb3G1sweep_n5top10 D5Gb4G1sweep_n5top10 D5Gb5G1sweep_n5top10


# these are a set of drain values holding gate 2 constant and sweeping through gate1
load infile=drain10
#naming convention Drain=1V, GateB=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D10Gb0G1sweep_n5top10
solve name=gate1 v3=0 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Gb1G1sweep_n5top10
solve name=gate1 v3=1 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Gb2G1sweep_n5top10
solve name=gate1 v3=2 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Gb3G1sweep_n5top10
solve name=gate1 v3=3 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Gb4G1sweep_n5top10
solve name=gate1 v3=4 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain10
log outfile=D10Gb5G1sweep_n5top10
solve name=gate1 v3=5 v2=-5 vfinal=10 vstep=0.5
log off


extract init infile="D10Gb0G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D10Gb1G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D10Gb2G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D10Gb3G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D10Gb4G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D10Gb5G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))


tonyplot -overlay D10Gb0G1sweep_n5top10 D10Gb1G1sweep_n5top10 D10Gb2G1sweep_n5top10 D10Gb3G1sweep_n5top10 D10Gb4G1sweep_n5top10 D10Gb5G1sweep_n5top10


# these are a set of drain values holding gate 2 constant and sweeping through gate1
load infile=drain15
#naming convention Drain=1V, GateB=0V,Gate2 is being swept between negative 5v and positive 10v
log outfile=D15Gb0G1sweep_n5top10
solve name=gate1 v3=0 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Gb1G1sweep_n5top10
solve name=gate1 v3=1 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Gb2G1sweep_n5top10
solve name=gate1 v3=2 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Gb3G1sweep_n5top10
solve name=gate1 v3=3 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Gb4G1sweep_n5top10
solve name=gate1 v3=4 v2=-5 vfinal=10 vstep=0.5
log off
load infile=drain15
log outfile=D15Gb5G1sweep_n5top10
solve name=gate1 v3=5 v2=-5 vfinal=10 vstep=0.5
log off


extract init infile="D15Gb0G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D15Gb1G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D15Gb2G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D15Gb3G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D15Gb4G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract init infile="D15Gb5G1sweep_n5top10"
extract name="Vt" xintercept(maxslope(curve(abs(v."gate1"),abs(i."drain"))))
extract name="idsmax" max(abs(i."drain"))
extract name="gm" slope(maxslope(curve(abs(v."gate1"),abs(i."drain"))))



tonyplot -overlay D15Gb0G1sweep_n5top10 D15Gb1G1sweep_n5top10 D15Gb2G1sweep_n5top10 D15Gb3G1sweep_n5top10 D15Gb4G1sweep_n5top10 D15Gb5G1sweep_n5top10

save outfile=LDMOS_STI04_p2e18e45_n2e16e100_nti10te1000_ver1_gate1sweep.str
#save outfile=gate2sweepdrain.str
tonyplot LDMOS_STI04_p2e18e45_n2e16e100_nti10te1000_ver1_gate1sweep.str



# The response time is modeled for select cases
# Assumptions: we are simulating a perfect square wave in a variety of frequencies, but we want to see how the LDMOS functions in the different frequency regimes outlined in our proposal. In reality, Silicon based LDMOS are not useable beyond 4GHz, however other simulations available online appear to show functionality in the 100GHz range. To simulate this very high frequency we will be assuming that for a 100GHz signal, 10% of its period is spent rising from 0 to its set amplitude. This implies that for a full non-ideal square wave a total of 40% of the cycle time is spent transitioning and 60% of the cycle is in the stable High or Low state. 

#I dont have an industry standard or theoretical reason for choosing this criteria, it just seemed reasonable to me.

# Later parts of the simulation will look at the frequency response and phase shift and use that to quantify the level of distortion more accurately.

# I have a theory regarding using the double gate feature of this device to produce an analog (or possibly digital) frequency modulated signal. This would involve using one of the gates as the driver for carrier signal and using the second gate to add the modulation. Additionally, this default configuration would be suited for this application because of its "always on" state at higher drain voltages (something we considered detrimental in the default usage case as a RF amplifier). I will add this experiment either to this section or make a section of its own, if time allows.

# This is not a full set of comparisons (which should include repeating at different drain voltages, but due to time limitations, I am leaving it here. This will be an area that will be improved in the future. 


 
load infile=drain1
log outfile=D1Ga3G2transient_5v_100GHzin
solve name=gate2 v2=3 v3=5 ramptime=1e-12 tstep=1e-14 tstop=3e-12
solve name=gate2 v2=3 v3=0 ramptime=1e-12 tstep=1e-14 tstop=1e-11
log off

tonyplot D1Ga3G2transient_5v_100GHzin


load infile=drain1
log outfile=D1Ga3G2transient_5v_10GHzin
solve name=gate2 v2=3 v3=5 ramptime=1e-11 tstep=1e-13 tstop=3e-11
solve name=gate2 v2=3 v3=0 ramptime=1e-11 tstep=1e-13 tstop=1e-10
log off

tonyplot D1Ga3G2transient_5v_10GHzin


load infile=drain1
log outfile=D1Ga3G2transient_5v_1GHzin
solve name=gate2 v2=3 v3=5 ramptime=1e-10 tstep=1e-12 tstop=3e-10
solve name=gate2 v2=3 v3=0 ramptime=1e-10 tstep=1e-12 tstop=1e-9
log off

tonyplot D1Ga3G2transient_5v_1GHzin


load infile=drain1
log outfile=D1Ga3G2transient_5v_10MHzin
solve name=gate2 v2=3 v3=5 ramptime=1e-8 tstep=1e-10 tstop=3e-8
solve name=gate2 v2=3 v3=0 ramptime=1e-8 tstep=1e-10 tstop=1e-7
log off

tonyplot D1Ga3G2transient_5v_10MHzin
# This makes me feel good, This is the first one that returned a response that indicates it is functional. It implies that our device is rather poor quality when compared to commercially available parts. ... WHICH IS EXACTLY WHAT SHOULD HAPPEN (to an unoptimized first generation, proof of concept design).


load infile=drain1
log outfile=D1Ga3G2transient_5v_100MHzin
solve name=gate2 v2=3 v3=5 ramptime=1e-9 tstep=1e-11 tstop=3e-9
solve name=gate2 v2=3 v3=0 ramptime=1e-9 tstep=1e-11 tstop=1e-8
log off

tonyplot D1Ga3G2transient_5v_100MHzin



##############################################################################
# AC signal example (for select frequencies)(therefore incomplete section)

load infile=drain1
#D1n5p5ac_1MHz
log outfile=D1Ga0Gbsweep_n5top10_AC_1MHz
# Drain=1v Gate1=0v gate2 swept from negative 5v to positive 10v at an 1MHz AC frequency
solve name=gate2 v2=0 v3=-5 vfinal= 10 vstep=0.5 ac frequency=100e4
log off

tonyplot D1Ga0Gbsweep_n5top10_AC_1MHz



load infile=drain1
#D1n5p5ac_1MHz
log outfile=D1Gb0Gasweep_n5top10_AC_1MHz
# Drain=1v Gate2=0v gate1 swept from negative 5v to positive 10v at an 1MHz AC frequency
solve name=gate1 v3=0 v2=-5 vfinal= 10 vstep=0.5 ac frequency=100e4
log off

tonyplot D1Gb0Gasweep_n5top10_AC_1MHz

########### end of incomplete AC section ##############

# Analysis of the large signal case needs to be added to the AC section (By default Atlas assumes that the AC signal is "small", and then uses the static equations to build upon. Our system, intended to be a relatively high voltage and amperage device however, would most likely fit the definition of a "large signal"

#
